# Configuration

## Next.js plugin options

The `workflowBuilder()` function accepts a `WorkflowConfig` object:

```ts
import workflowBuilder from "next-workflow-builder";

const withWorkflowBuilder = workflowBuilder({
  theme: "system",
  apiRoute: "/api",
  autoGenerateApiRoute: true,
  dbImportPath: "@/lib/db",
  authImportPath: "@/lib/auth",
  ai: {
    provider: "openai",
    model: "gpt-4",
  },
});
```

### Options

| Option | Type | Default | Description |
| --- | --- | --- | --- |
| `theme` | `"light" \| "dark" \| "system"` | `"system"` | UI color theme |
| `apiRoute` | `string` | `"/api"` | Base path for API route handlers |
| `autoGenerateApiRoute` | `boolean` | `true` | Auto-generate the catch-all API route file |
| `dbImportPath` | `string` | `"@/lib/db"` | Import path for the database module in generated routes |
| `authImportPath` | `string` | `"@/lib/auth"` | Import path for the auth module in generated routes |
| `ai` | `object` | `undefined` | AI-powered workflow generation config |
| `ai.provider` | `"openai" \| "anthropic"` | - | AI provider to use |
| `ai.model` | `string` | - | Model name (e.g., `"gpt-4"`, `"claude-sonnet-4-5-20250929"`) |

## API handler options

The `createWorkflowApiHandler()` function accepts options to customize authentication and routing:

```ts
import { createWorkflowApiHandler } from "next-workflow-builder";
import pluginRoutes from "@/lib/route-registry";

const handler = createWorkflowApiHandler({
  pluginRoutes,
  authOptions: {
    emailAndPassword: {
      enabled: true,
      requireEmailVerification: false,
    },
    socialProviders: {
      github: {
        clientId: process.env.GITHUB_CLIENT_ID || "",
        clientSecret: process.env.GITHUB_CLIENT_SECRET || "",
      },
    },
  },
});
```

### Options

| Option | Type | Description |
| --- | --- | --- |
| `pluginRoutes` | `RouteDefinition[]` | Custom API routes from plugins (auto-generated by `nwb discover-plugins`) |
| `authOptions` | `BetterAuthOptions` | Override default Better Auth options (merged with defaults) |

## Environment variables

| Variable | Required | Description |
| --- | --- | --- |
| `NEXT_WORKFLOW_BUILDER_DATABASE_URL` | Yes | PostgreSQL connection string |
| `BETTER_AUTH_URL` | Yes | Base URL for Better Auth (e.g., `http://localhost:3000`) |
| `NEXT_PUBLIC_APP_URL` | No | Public app URL (alternative to `BETTER_AUTH_URL`) |
| `VERCEL_URL` | No | Auto-set by Vercel for preview deployments |

Plugin-specific environment variables are defined by each plugin's `formFields[].envVar` configuration.
See [Plugins](/docs/plugins) for details.
